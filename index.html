<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cat√°logo Premium Pro</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            color: #333;
            line-height: 1.6;
            padding-bottom: 50px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        /* HEADER MEJORADO */
        header {
            text-align: center;
            padding: 40px 0;
            background: linear-gradient(135deg, #2c3e50, #4a6491);
            color: white;
            border-radius: 15px;
            margin-bottom: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            position: relative;
            overflow: hidden;
        }

        header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, #25D366, #3498db, #e74c3c);
        }

        header h1 {
            font-size: 2.8rem;
            margin-bottom: 15px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        header p {
            font-size: 1.2rem;
            opacity: 0.9;
            margin-bottom: 20px;
        }

        .header-stats {
            display: flex;
            justify-content: center;
            gap: 30px;
            flex-wrap: wrap;
            margin-top: 20px;
        }

        .header-stats span {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 0.95rem;
            padding: 8px 15px;
            background: rgba(255,255,255,0.1);
            border-radius: 20px;
        }

        /* BARRA DE B√öSQUEDA Y FILTROS */
        .controls-bar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            flex-wrap: wrap;
            gap: 15px;
            background: white;
            padding: 15px 25px;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.05);
        }

        .search-box {
            flex: 1;
            min-width: 250px;
            position: relative;
        }

        .search-box input {
            width: 100%;
            padding: 12px 45px 12px 15px;
            border: 2px solid #e3e7ec;
            border-radius: 8px;
            font-size: 1rem;
            transition: all 0.3s;
        }

        .search-box input:focus {
            outline: none;
            border-color: #3498db;
            box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.2);
        }

        .search-box i {
            position: absolute;
            right: 15px;
            top: 50%;
            transform: translateY(-50%);
            color: #7f8c8d;
        }

        .filter-buttons {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        .filter-btn {
            padding: 10px 20px;
            background: #f8f9fa;
            border: 2px solid #e3e7ec;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            color: #2c3e50;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .filter-btn:hover {
            background: #e3f2fd;
            border-color: #3498db;
        }

        .filter-btn.active {
            background: #3498db;
            color: white;
            border-color: #3498db;
        }

        /* CONTADOR DE PRODUCTOS */
        .product-counter {
            background: #f8f9fa;
            padding: 10px 20px;
            border-radius: 8px;
            font-weight: 600;
            color: #2c3e50;
            border: 1px solid #e3e7ec;
        }

        /* GRID DE PRODUCTOS */
        .catalog-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 25px;
            margin-bottom: 40px;
        }

        .product-card {
            background: white;
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(0,0,0,0.08);
            transition: all 0.3s ease;
            position: relative;
            animation: fadeIn 0.5s ease-out;
        }

        .product-card:hover {
            transform: translateY(-10px);
            box-shadow: 0 15px 30px rgba(0,0,0,0.15);
        }

        /* IM√ÅGENES OPTIMIZADAS */
        .product-image {
            height: 220px;
            width: 100%;
            object-fit: contain;
            padding: 15px;
            background: #f8f9fa;
            border-bottom: 1px solid #eee;
            transition: transform 0.3s ease;
        }

        .product-card:hover .product-image {
            transform: scale(1.05);
        }

        .product-info {
            padding: 20px;
        }

        .product-title {
            font-size: 1.2rem;
            font-weight: 700;
            margin-bottom: 8px;
            color: #2c3e50;
            height: 60px;
            overflow: hidden;
        }

        .product-sku {
            font-size: 0.85rem;
            color: #7f8c8d;
            margin-bottom: 10px;
        }

        .product-price {
            font-size: 1.5rem;
            font-weight: 800;
            color: #e74c3c;
            margin-bottom: 15px;
        }

        .product-badge {
            position: absolute;
            top: 15px;
            right: 15px;
            background: #e74c3c;
            color: white;
            padding: 5px 10px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
        }

        .product-badge.category {
            background: #3498db;
            top: 50px;
        }

        /* BOT√ìN DE COMPARTIR ENLACE */
        .share-button {
            position: absolute;
            top: 15px;
            left: 15px;
            width: 36px;
            height: 36px;
            background: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            box-shadow: 0 3px 10px rgba(0,0,0,0.1);
            transition: all 0.3s;
            z-index: 10;
            border: none;
            color: #3498db;
            font-size: 1rem;
        }

        .share-button:hover {
            background: #3498db;
            color: white;
            transform: scale(1.1);
        }

        .share-tooltip {
            position: absolute;
            top: 50px;
            left: 0;
            background: white;
            padding: 10px;
            border-radius: 8px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            display: none;
            min-width: 250px;
            z-index: 100;
        }

        .share-button:hover .share-tooltip {
            display: block;
        }

        .share-tooltip input {
            width: 100%;
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 0.9rem;
            margin-bottom: 5px;
        }

        .copy-btn {
            width: 100%;
            padding: 8px;
            background: #25D366;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.9rem;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 5px;
        }

        /* BOTONES DE ACCI√ìN */
        .product-actions {
            display: flex;
            gap: 10px;
            margin-top: 15px;
        }

        .view-button {
            flex: 1;
            padding: 10px;
            background: #3498db;
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 0.9rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 6px;
        }

        .buy-button {
            flex: 1;
            padding: 10px;
            background: linear-gradient(135deg, #25D366, #128C7E);
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 0.9rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 6px;
        }

        .view-button:hover {
            background: #2980b9;
            transform: scale(1.05);
        }

        .buy-button:hover {
            background: linear-gradient(135deg, #128C7E, #075E54);
            transform: scale(1.05);
        }

        @keyframes pulse {
            0% { box-shadow: 0 5px 15px rgba(37, 211, 102, 0.3); }
            50% { box-shadow: 0 5px 20px rgba(37, 211, 102, 0.6); }
            100% { box-shadow: 0 5px 15px rgba(37, 211, 102, 0.3); }
        }

        .buy-button.pulse {
            animation: pulse 2s ease-in-out infinite;
        }

        /* MODALES (estilos originales mantienen) */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7);
            z-index: 1000;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }

        .modal-content {
            background: white;
            border-radius: 15px;
            width: 100%;
            max-width: 800px;
            max-height: 90vh;
            overflow-y: auto;
            padding: 30px;
            position: relative;
            box-shadow: 0 20px 40px rgba(0,0,0,0.2);
        }

        .close-modal {
            position: absolute;
            top: 15px;
            right: 20px;
            font-size: 28px;
            cursor: pointer;
            color: #7f8c8d;
        }

        .close-modal:hover {
            color: #e74c3c;
        }

        .modal h2 {
            margin-bottom: 20px;
            color: #2c3e50;
            font-size: 1.8rem;
            border-bottom: 2px solid #3498db;
            padding-bottom: 10px;
        }

        /* Estilos espec√≠ficos para modal de detalles */
        .product-detail-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin-bottom: 25px;
        }

        .product-detail-image {
            width: 100%;
            height: 300px;
            object-fit: contain;
            border-radius: 10px;
            border: 1px solid #eee;
            padding: 10px;
            background: #f9f9f9;
        }

        .product-detail-info h3 {
            font-size: 1.8rem;
            margin-bottom: 10px;
            color: #2c3e50;
        }

        .product-detail-price {
            font-size: 2rem;
            font-weight: 800;
            color: #e74c3c;
            margin-bottom: 15px;
        }

        .product-detail-sku {
            font-size: 0.9rem;
            color: #7f8c8d;
            margin-bottom: 15px;
            padding: 8px 12px;
            background: #f5f5f5;
            border-radius: 6px;
            display: inline-block;
        }

        .product-description {
            margin: 25px 0;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 10px;
            border-left: 4px solid #3498db;
        }

        .product-description h4 {
            color: #2c3e50;
            margin-bottom: 10px;
            font-size: 1.2rem;
        }

        .product-description p {
            color: #555;
            line-height: 1.8;
        }

        .product-features {
            margin: 25px 0;
        }

        .product-features h4 {
            color: #2c3e50;
            margin-bottom: 15px;
            font-size: 1.2rem;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .features-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 15px;
        }

        .feature-item {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 12px;
            background: white;
            border-radius: 8px;
            border: 1px solid #e3e7ec;
            transition: all 0.2s;
        }

        .feature-item:hover {
            border-color: #3498db;
            transform: translateY(-2px);
        }

        .feature-icon {
            color: #3498db;
            font-size: 1.2rem;
        }

        .feature-text {
            font-size: 0.95rem;
        }

        .detail-actions {
            display: flex;
            gap: 15px;
            margin-top: 25px;
        }

        .detail-buy-button {
            flex: 1;
            padding: 15px;
            background: linear-gradient(135deg, #25D366, #128C7E);
            color: white;
            border: none;
            border-radius: 10px;
            font-size: 1.1rem;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            box-shadow: 0 5px 15px rgba(37, 211, 102, 0.3);
        }

        .detail-buy-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(37, 211, 102, 0.4);
            background: linear-gradient(135deg, #128C7E, #075E54);
        }

        .detail-close-button {
            flex: 1;
            padding: 15px;
            background: #95a5a6;
            color: white;
            border: none;
            border-radius: 10px;
            font-size: 1.1rem;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }

        .detail-close-button:hover {
            background: #7f8c8d;
            transform: translateY(-2px);
        }

        /* Modal de compra */
        .modal-product-info {
            display: flex;
            gap: 20px;
            margin-bottom: 25px;
            padding-bottom: 20px;
            border-bottom: 1px solid #eee;
        }

        .modal-product-image {
            width: 120px;
            height: 120px;
            object-fit: cover;
            border-radius: 10px;
        }

        .modal-product-details h3 {
            font-size: 1.3rem;
            margin-bottom: 8px;
        }

        .modal-product-price {
            font-size: 1.5rem;
            font-weight: 800;
            color: #e74c3c;
            margin-bottom: 10px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #2c3e50;
        }

        .form-control {
            width: 100%;
            padding: 12px 15px;
            border: 1px solid #ddd;
            border-radius: 8px;
            font-size: 1rem;
            transition: border 0.3s;
        }

        .form-control:focus {
            outline: none;
            border-color: #25D366;
            box-shadow: 0 0 0 3px rgba(37, 211, 102, 0.2);
        }

        .size-options {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
        }

        .size-option {
            width: 45px;
            height: 45px;
            display: flex;
            align-items: center;
            justify-content: center;
            border: 2px solid #ddd;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.2s;
        }

        .size-option:hover {
            border-color: #25D366;
        }

        .size-option.selected {
            background: #25D366;
            color: white;
            border-color: #25D366;
        }

        .quantity-selector {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .quantity-btn {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            border: 2px solid #25D366;
            background: white;
            color: #25D366;
            font-size: 1.2rem;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s;
        }

        .quantity-btn:hover {
            background: #25D366;
            color: white;
        }

        .quantity-display {
            font-size: 1.5rem;
            font-weight: 700;
            min-width: 40px;
            text-align: center;
        }

        .shipping-option {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 15px;
            border: 2px solid #ddd;
            border-radius: 10px;
            margin-bottom: 10px;
            cursor: pointer;
            transition: all 0.2s;
        }

        .shipping-option:hover {
            border-color: #25D366;
        }

        .shipping-option.selected {
            border-color: #25D366;
            background-color: rgba(37, 211, 102, 0.05);
        }

        .shipping-option input {
            margin: 0;
        }

        .shipping-price {
            margin-left: auto;
            font-weight: 700;
            color: #e74c3c;
        }

        /* VALIDACI√ìN PARA M√öLTIPLES PLANTILLAS */
        .size-validation-message {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            color: #856404;
            padding: 10px;
            border-radius: 8px;
            margin: 10px 0;
            display: none;
            font-size: 0.9rem;
        }

        .size-validation-message.show {
            display: block;
        }

        .multi-template-info {
            background: #e3f2fd;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 15px;
            border-left: 4px solid #3498db;
        }

        .multi-template-info i {
            color: #3498db;
            margin-right: 10px;
        }

        .template-list {
            margin-top: 10px;
            padding-left: 20px;
        }

        .template-list li {
            margin: 5px 0;
            padding: 5px;
            background: rgba(255,255,255,0.8);
            border-radius: 4px;
        }

        .order-summary {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 20px;
            margin-top: 25px;
        }

        .summary-row {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
        }

        .summary-total {
            font-size: 1.4rem;
            font-weight: 800;
            color: #2c3e50;
            border-top: 2px dashed #ddd;
            padding-top: 15px;
            margin-top: 10px;
        }

        .modal-whatsapp-btn {
            width: 100%;
            padding: 16px;
            background: linear-gradient(135deg, #25D366, #128C7E);
            color: white;
            border: none;
            border-radius: 12px;
            font-size: 1.1rem;
            font-weight: 800;
            cursor: pointer;
            margin-top: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            box-shadow: 0 8px 25px rgba(37, 211, 102, 0.4);
            transition: all 0.3s ease;
        }

        .modal-whatsapp-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 12px 30px rgba(37, 211, 102, 0.6);
            background: linear-gradient(135deg, #128C7E, #075E54);
        }

        .modal-whatsapp-btn:disabled {
            opacity: 0.7;
            cursor: not-allowed;
        }

        /* CARRITO FLOTANTE */
        .cart-section {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 1000;
        }

        .cart-button {
            position: relative;
            background: white;
            border: none;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            font-size: 1.2rem;
            color: #2c3e50;
            transition: all 0.3s;
        }

        .cart-button:hover {
            background: #3498db;
            color: white;
            transform: translateY(-2px);
        }

        .cart-count {
            position: absolute;
            top: -5px;
            right: -5px;
            background: #e74c3c;
            color: white;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            font-size: 0.8rem;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
        }

        /* ANIMACIONES */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        footer {
            text-align: center;
            padding: 30px 0;
            color: #7f8c8d;
            margin-top: 40px;
            border-top: 1px solid #eee;
        }

        /* RESPONSIVE */
        @media (max-width: 768px) {
            .catalog-grid {
                grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
                gap: 20px;
            }
            
            header h1 {
                font-size: 2.2rem;
            }
            
            .modal-content {
                padding: 20px;
            }
            
            .product-detail-container {
                grid-template-columns: 1fr;
            }
            
            .modal-product-info {
                flex-direction: column;
                align-items: center;
                text-align: center;
            }
            
            .detail-actions {
                flex-direction: column;
            }
            
            .controls-bar {
                flex-direction: column;
                align-items: stretch;
            }
            
            .search-box {
                min-width: 100%;
            }
            
            .filter-buttons {
                justify-content: center;
            }
            
            .cart-section {
                top: 10px;
                right: 10px;
            }
        }

        @media (max-width: 480px) {
            .catalog-grid {
                grid-template-columns: 1fr;
            }
            
            .container {
                padding: 10px;
            }
            
            header {
                padding: 20px 0;
            }
            
            header h1 {
                font-size: 1.8rem;
            }
            
            .product-actions {
                flex-direction: column;
            }
            
            .header-stats {
                flex-direction: column;
                gap: 10px;
            }
        }
    </style>
</head>
<body>
    <!-- Bot√≥n de carrito flotante -->
    <div class="cart-section">
        <button class="cart-button" id="cartButton">
            <i class="fas fa-shopping-cart"></i>
            <span class="cart-count" id="cartCount">0</span>
        </button>
    </div>

    <div class="container">
        <header>
            <h1><i class="fas fa-crown"></i> Cat√°logo Premium Pro</h1>
            <p>Productos de calidad con entregas r√°pidas y atenci√≥n personalizada</p>
            <div class="header-stats">
                <span><i class="fas fa-star"></i> 4.8/5 (256 rese√±as)</span>
                <span><i class="fas fa-shipping-fast"></i> Env√≠o Gratis +30.000</span>
                <span><i class="fas fa-shield-alt"></i> Garant√≠a 30 d√≠as</span>
            </div>
        </header>

        <!-- Barra de b√∫squeda y filtros -->
        <div class="controls-bar">
            <div class="search-box">
                <input type="text" id="searchInput" placeholder="Buscar productos por nombre o SKU...">
                <i class="fas fa-search"></i>
            </div>
            
            <div class="filter-buttons">
                <button class="filter-btn active" data-filter="all">
                    <i class="fas fa-th"></i> Todos
                </button>
                <button class="filter-btn" data-filter="plantilla">
                    <i class="fas fa-shoe-prints"></i> Plantillas
                </button>
                <button class="filter-btn" data-filter="electronico">
                    <i class="fas fa-bolt"></i> Electr√≥nicos
                </button>
                <button class="filter-btn" data-filter="hogar">
                    <i class="fas fa-home"></i> Hogar
                </button>
                <button class="filter-btn" data-filter="salud">
                    <i class="fas fa-heartbeat"></i> Salud
                </button>
                <button class="filter-btn" data-filter="herramienta">
                    <i class="fas fa-tools"></i> Herramientas
                </button>
            </div>
            
            <div class="product-counter" id="productCounter">
                Cargando productos...
            </div>
        </div>

        <!-- Grid de productos -->
        <div class="catalog-grid" id="catalog">
            <!-- Los productos se cargar√°n con JavaScript -->
        </div>

        <footer>
            <p>¬© 2023 Cat√°logo Premium Pro - Todos los derechos reservados</p>
            <p>Env√≠os a todo el pa√≠s | Pagos seguros | Garant√≠a de calidad | Soporte 24/7</p>
        </footer>
    </div>

    <!-- Modal de detalles del producto -->
    <div class="modal" id="detailModal">
        <div class="modal-content">
            <span class="close-modal" id="closeDetailModal">&times;</span>
            <h2>Detalles del Producto</h2>
            
            <div id="productDetailContent">
                <!-- Contenido din√°mico de detalles del producto -->
            </div>
        </div>
    </div>

    <!-- Modal de compra -->
    <div class="modal" id="purchaseModal">
        <div class="modal-content">
            <span class="close-modal" id="closeModal">&times;</span>
            <h2>Completar Compra</h2>
            
            <!-- Informaci√≥n de m√∫ltiples plantillas -->
            <div id="multiTemplateInfo" class="multi-template-info" style="display: none;">
                <i class="fas fa-info-circle"></i>
                <span id="templateMessage">Est√°s comprando 1 plantilla. Selecciona tu calce:</span>
                <ul id="templateList" class="template-list"></ul>
            </div>
            
            <div class="modal-product-info">
                <img id="modalProductImage" src="" alt="Producto" class="modal-product-image">
                <div class="modal-product-details">
                    <h3 id="modalProductTitle"></h3>
                    <p id="modalProductSku"></p>
                    <div class="modal-product-price" id="modalProductPrice"></div>
                </div>
            </div>

            <!-- Mensaje de validaci√≥n para calces -->
            <div class="size-validation-message" id="sizeValidationMessage">
                Debes seleccionar un calce para cada plantilla antes de continuar.
            </div>

            <form id="purchaseForm">
                <!-- Opci√≥n de cantidad -->
                <div class="form-group">
                    <label for="quantity">Cantidad:</label>
                    <div class="quantity-selector">
                        <button type="button" class="quantity-btn" id="decreaseQty">-</button>
                        <div class="quantity-display" id="quantityDisplay">1</div>
                        <button type="button" class="quantity-btn" id="increaseQty">+</button>
                    </div>
                </div>

                <!-- Selector de calce (solo para plantillas) -->
                <div class="form-group" id="sizeContainer" style="display: none;">
                    <label>Selecciona tu calce:</label>
                    <div class="size-options" id="sizeOptions">
                        <!-- Las opciones de tama√±o se generar√°n din√°micamente -->
                    </div>
                </div>

                <!-- Opciones de env√≠o -->
                <div class="form-group">
                    <label>M√©todo de env√≠o:</label>
                    <div class="shipping-option" id="standardShipping">
                        <input type="radio" name="shipping" id="shippingStandard" value="standard" checked>
                        <label for="shippingStandard">Env√≠o est√°ndar (3-5 d√≠as)</label>
                        <span class="shipping-price">Gratis</span>
                    </div>
                    <div class="shipping-option" id="expressShipping">
                        <input type="radio" name="shipping" id="shippingExpress" value="express">
                        <label for="shippingExpress">Env√≠o r√°pido (24-48 horas)</label>
                        <span class="shipping-price">8.000 Gs</span>
                    </div>
                </div>

                <!-- Informaci√≥n del cliente -->
                <div class="form-group">
                    <label for="customerName">Nombre completo:*</label>
                    <input type="text" id="customerName" class="form-control" placeholder="Ingresa tu nombre" required>
                </div>

                <div class="form-group">
                    <label for="customerPhone">Tel√©fono:*</label>
                    <input type="tel" id="customerPhone" class="form-control" placeholder="Ej: 0981 123456" required>
                </div>

                <div class="form-group">
                    <label for="customerAddress">Direcci√≥n de entrega:*</label>
                    <textarea id="customerAddress" class="form-control" rows="3" placeholder="Calle, n√∫mero, barrio, ciudad" required></textarea>
                </div>

                <div class="order-summary">
                    <h3>Resumen de compra</h3>
                    <div class="summary-row">
                        <span>Subtotal:</span>
                        <span id="subtotalAmount">0 Gs</span>
                    </div>
                    <div class="summary-row">
                        <span>Env√≠o:</span>
                        <span id="shippingAmount">0 Gs</span>
                    </div>
                    <div class="summary-row summary-total">
                        <span>TOTAL:</span>
                        <span id="totalAmount">0 Gs</span>
                    </div>
                </div>

                <button type="button" class="modal-whatsapp-btn" id="whatsappButton" disabled>
                    <i class="fab fa-whatsapp"></i> Completar compra por WhatsApp
                </button>
            </form>
        </div>
    </div>

    <script>
        // Base de datos de caracter√≠sticas por categor√≠a
        const productFeatures = {
            plantilla: [
                { icon: "fas fa-shoe-prints", text: "Material ortop√©dico 5D" },
                { icon: "fas fa-heartbeat", text: "Soporte para arco plantar" },
                { icon: "fas fa-weight", text: "Amortiguaci√≥n de impacto" },
                { icon: "fas fa-wind", text: "Material transpirable" },
                { icon: "fas fa-ruler-combined", text: "Calces disponibles: 35-45" },
                { icon: "fas fa-hand-holding-heart", text: "Alivia dolores de espalda" }
            ],
            electronico: [
                { icon: "fas fa-bolt", text: "Bater√≠a recargable" },
                { icon: "fas fa-usb", text: "Carga USB" },
                { icon: "fas fa-clock", text: "Autonom√≠a prolongada" },
                { icon: "fas fa-tachometer-alt", text: "Alta potencia" },
                { icon: "fas fa-shield-alt", text: "Certificaci√≥n de seguridad" },
                { icon: "fas fa-lightbulb", text: "Tecnolog√≠a LED" }
            ],
            hogar: [
                { icon: "fas fa-home", text: "Para uso dom√©stico" },
                { icon: "fas fa-broom", text: "F√°cil de limpiar" },
                { icon: "fas fa-tools", text: "Montaje sencillo" },
                { icon: "fas fa-expand-arrows-alt", text: "Ajustable" },
                { icon: "fas fa-layer-group", text: "Varios niveles" },
                { icon: "fas fa-recycle", text: "Material duradero" }
            ],
            salud: [
                { icon: "fas fa-heart", text: "Mejora la circulaci√≥n" },
                { icon: "fas fa-hand-holding-medical", text: "Terap√©utico" },
                { icon: "fas fa-user-md", text: "Recomendado por especialistas" },
                { icon: "fas fa-spa", text: "Alivia tensiones" },
                { icon: "fas fa-temperature-low", text: "Material t√©rmico" },
                { icon: "fas fa-capsules", text: "Efecto antiinflamatorio" }
            ],
            herramienta: [
                { icon: "fas fa-wrench", text: "Multifuncional" },
                { icon: "fas fa-battery-full", text: "Sin cables" },
                { icon: "fas fa-compress-arrows-alt", text: "Port√°til" },
                { icon: "fas fa-toolbox", text: "Kit completo" },
                { icon: "fas fa-cogs", text: "Precisi√≥n ajustable" },
                { icon: "fas fa-hard-hat", text: "Uso profesional" }
            ]
        };

        // Descripciones por categor√≠a
        const productDescriptions = {
            plantilla: "Plantilla ortop√©dica de √∫ltima generaci√≥n con tecnolog√≠a 5D que proporciona soporte integral al pie. Dise√±ada para distribuir uniformemente la presi√≥n, reducir la fatiga y prevenir lesiones. Ideal para personas que pasan largas horas de pie o con problemas de pisada.",
            electronico: "Dispositivo electr√≥nico de alta tecnolog√≠a con las √∫ltimas innovaciones en su categor√≠a. Funcional, eficiente y dise√±ado para facilitar tu d√≠a a d√≠a con un rendimiento √≥ptimo y consumo energ√©tico reducido.",
            hogar: "Producto pr√°ctico para el hogar que combina funcionalidad y dise√±o. Facilita las tareas diarias, optimiza espacios y mejora la organizaci√≥n de tu casa con materiales de alta calidad y durabilidad.",
            salud: "Producto dise√±ado para mejorar tu bienestar y calidad de vida. Desarrollado con criterios terap√©uticos y ergon√≥micos para proporcionar alivio y comodidad en tu rutina diaria.",
            herramienta: "Herramienta vers√°til y eficiente para m√∫ltiples aplicaciones. Construida con materiales resistentes y tecnolog√≠a de punta para un rendimiento profesional y duradero."
        };

        // Datos completos de productos (100% de los productos proporcionados)
        const products = [
            {
                title: "PLANTILLA ORTOP√âDICA | ORTOPIEX 5D¬Æ",
                sku: "PLANTILLA ORTOP√âDICA | ORTOPIEX 5D¬Æ - 001",
                price: 159000,
                image_url: "https://www.skylinestoree.online/cdn/shop/files/ChatGPT_Image_8_jun_2025_01_04_14_a.m..png?v=1757629829&width=600",
                isPlantilla: true,
                category: "plantilla"
            },
            {
                title: "MINI ASPIRADORA",
                sku: "MINI ASPIRADORA - 002",
                price: 119900,
                image_url: "https://cdn.shopify.com/s/files/1/0885/3012/5095/files/ChatGPT_Image_9_ago_2025_09_49_46_p.m._ee0d4101-4eb8-45cf-9b23-e5e1d8c6288c.png?v=1755580613",
                isPlantilla: false,
                category: "hogar"
            },
            {
                title: "PLUMERO EXTENSIBLE 2.80 M",
                sku: "PLUMERO EXTENSIBLE 2.80 M - 003",
                price: 109000,
                image_url: "https://cdn.shopify.com/s/files/1/0707/1979/9484/files/Captura_de_pantalla_2025-10-30_005208.jpg?v=1762320213",
                isPlantilla: false,
                category: "hogar"
            },
            {
                title: "HUEVERA ELECTRICA EN FORMA DE GALLINITA",
                sku: "HUEVERA ELECTRICA EN FORMA DE GALLINITA - 004",
                price: 127900,
                image_url: "https://i5.walmartimages.com/asr/38287ab5-5cf3-4aa2-a7ff-e7d3e60a240d.ed14180e8b1a0f73bc88f4cf03082575.png?odnHeight=612&odnWidth=612&odnBg=FFFFFF",
                isPlantilla: false,
                category: "electronico"
            },
            {
                title: "SOPORTE ANTIVIBRACI√ìN Y NIVELADORAS X 4",
                sku: "SOPORTE ANTIVIBRACI√ìN Y NIVELADORAS X 4 - 005",
                price: 99000,
                image_url: "https://http2.mlstatic.com/D_923417-MLA87858875006_072025-C.jpg",
                isPlantilla: false,
                category: "herramienta"
            },
            {
                title: "üíôü¶∂ Pack Bienestar: 2 Pares de Medias Terap√©uticas",
                sku: "üíôü¶∂ Pack Bienestar: 2 Pares de Medias Terap√©uticas - 006",
                price: 120000,
                image_url: "https://jv7dta-ka.myshopify.com/cdn/shop/files/ChatGPTImage19ago2025_01_50_42a.m..png?v=1755579070&width=600",
                isPlantilla: false,
                category: "salud"
            },
            {
                title: "Afilador de Cuchillos y Tijerasüî™‚úÇÔ∏è",
                sku: "Afilador de Cuchillos y Tijerasüî™‚úÇÔ∏è - 007",
                price: 109000,
                image_url: "https://jv7dta-ka.myshopify.com/cdn/shop/files/afilador1.webp?v=1753405987&width=600",
                isPlantilla: false,
                category: "hogar"
            },
            {
                title: "CREMA PARA HONGO",
                sku: "CREMA PARA HONGO - 008",
                price: 120000,
                image_url: "https://cdn.shopify.com/s/files/1/0707/1979/9484/files/WhatsApp_Image_2025-06-30_at_02.07.48.jpg?v=1758810936",
                isPlantilla: false,
                category: "salud"
            },
            {
                title: "Encendedor El√©ctrico Recargable Usb",
                sku: "Encendedor El√©ctrico Recargable Usb - 009",
                price: 129900,
                image_url: "https://oechsle.vteximg.com.br/arquivos/ids/21575089-1000-1000/imageUrl_1.jpg?v=638872943568970000",
                isPlantilla: false,
                category: "electronico"
            },
            {
                title: "PIZARRA MAGICA",
                sku: "PIZARRA MAGICA - 010",
                price: 189900,
                image_url: "https://cdn.shopify.com/s/files/1/0885/3012/5095/files/Capturadepantalla2025-12-03014757_45217c0a-ad15-4a8b-87bb-3e8927915024.jpg?v=1764737323",
                isPlantilla: false,
                category: "hogar"
            },
            {
                title: "SOPORTE REGULABLE PARA ELECTRODOMESTICOS",
                sku: "SOPORTE REGULABLE PARA ELECTRODOMESTICOS - 011",
                price: 119900,
                image_url: "https://cdn.shopify.com/s/files/1/0707/1979/9484/files/Captura_de_pantalla_2025-08-31_013252.png?v=1756670358",
                isPlantilla: false,
                category: "hogar"
            },
            {
                title: "RoyalBee Wax CERA PARA MADERA Y CUERO‚ú®",
                sku: "RoyalBee Wax CERA PARA MADERA Y CUERO‚ú® - 012",
                price: 120000,
                image_url: "https://jv7dta-ka.myshopify.com/cdn/shop/files/ChatGPT_Image_4_oct_2025_03_57_23_p.m..png?v=1759604271&width=600",
                isPlantilla: false,
                category: "hogar"
            },
            {
                title: "LINTERNA POTENTE CON ZOOM",
                sku: "LINTERNA POTENTE CON ZOOM - 013",
                price: 189900,
                image_url: "https://acdn-us.mitiendanube.com/stores/001/131/056/products/linterr1-883f44649ed5698ece16878282190084-640-0.jpg",
                isPlantilla: false,
                category: "electronico"
            },
            {
                title: "CORRECTOR DE POSTURA X",
                sku: "CORRECTOR DE POSTURA X - 014",
                price: 179900,
                image_url: "https://www.skylinestoree.online/cdn/shop/files/fajacorrectora3_540x_d6e03ef1-f416-4751-aba8-e8d3bd49dd95.jpg?v=1752811848&width=600",
                isPlantilla: false,
                category: "salud"
            },
            {
                title: "Jet Pro¬Æ Mini Soplador Turbo",
                sku: "Jet Pro¬Æ Mini Soplador Turbo - 015",
                price: 220000,
                image_url: "https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTV8S3FjFvKNos16XPw434bgus3zrY92CUuSw&s",
                isPlantilla: false,
                category: "herramienta"
            },
            {
                title: "MINI COMPRESOR DE AIRE",
                sku: "MINI COMPRESOR DE AIRE- 016",
                price: 259000,
                image_url: "https://cdn.shopify.com/s/files/1/0707/1979/9484/files/Captura_de_pantalla_2026-01-15_110421.jpg?v=1768485910",
                isPlantilla: false,
                category: "herramienta"
            },
            {
                title: "FOCO CAMARA",
                sku: "FOCO CAMARA- 017",
                price: 129900,
                image_url: "https://cdn.shopify.com/s/files/1/0707/1979/9484/files/Captura_de_pantalla_2026-01-15_111223.jpg?v=1768486364",
                isPlantilla: false,
                category: "electronico"
            },
            {
                title: "ESPEJO CON LUZ LED",
                sku: "ESPEJO CON LUZ LED - 018",
                price: 129900,
                image_url: "https://gofix.com.ar/wp-content/uploads/2023/10/LEDMirrorCarSunvisorVanityAccessoriesLightMakeupWomen_3_541816c3-1d36-49e7-91c3-93b35498de97_900x.webp",
                isPlantilla: false,
                category: "hogar"
            },
            {
                title: "LINTERNA CON PICANA",
                sku: "LINTERNA CON PICANA- 019",
                price: 129900,
                image_url: "https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTdWmC6pF_KQ9lGwvPYhfkOON8vACP06bpJ8A&s",
                isPlantilla: false,
                category: "electronico"
            },
            {
                title: "SOPORTE IMPERMEABLE GIRATORIO",
                sku: "SOPORTE IMPERMEABLE GIRATORIO - 020",
                price: 129900,
                image_url: "https://m.media-amazon.com/images/I/819eHrOGc2L._AC_SL1500_.jpg",
                isPlantilla: false,
                category: "hogar"
            },
            {
                title: "AURICULAR M10",
                sku: "AURICULAR M10 - 021",
                price: 129900,
                image_url: "https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcT5X6iw6RU3fblN7hl9Admzu1ZqikbhavQKzA&s",
                isPlantilla: false,
                category: "electronico"
            },
            {
                title: "MINI MASAJEADOR",
                sku: "MINI MASAJEADOR - 022",
                price: 99000,
                image_url: "https://cdn.shopify.com/s/files/1/0707/1979/9484/files/MINI_MASAJEADOR.jpg?v=1768485911",
                isPlantilla: false,
                category: "salud"
            },
            {
                title: "BARRA LUZ LED DE EMERGENCIA 70 CM",
                sku: "BARRA LUZ LED DE EMERGENCIA- 023",
                price: 129900,
                image_url: "https://http2.mlstatic.com/D_NQ_NP_2X_924939-MLB80296648992_112024-F-luminaria-led-barra-de-luz-emergncia-52cm-recarregavel-usb.webp",
                isPlantilla: false,
                category: "electronico"
            },
            {
                title: "RODILLERA DE COMPRESION",
                sku: "RODILLERA DE COMPRESION - 024",
                price: 109000,
                image_url: "https://cdn.shopify.com/s/files/1/0707/1979/9484/files/image_20240426182600-5c972456166d0e084f17141684868750-480-0.jpg?v=1762487809",
                isPlantilla: false,
                category: "salud"
            },
            {
                title: "TOBILLERA DE COMPRESI√ìN",
                sku: "TOBILLERA DE COMPRESI√ìN - 025",
                price: 109000,
                image_url: "https://cdn.shopify.com/s/files/1/0707/1979/9484/files/tobillera.jpg?v=1762705987",
                isPlantilla: false,
                category: "salud"
            },
            {
                title: "üîµ‚úÖTABLA DE PICAR - INOX PRO 304",
                sku: "üîµ‚úÖTABLA DE PICAR - INOX PRO 304 -",
                price: 499000,
                image_url: "https://cdn.shopify.com/s/files/1/0658/1095/6454/files/8137OArDerL.jpg?v=1768077320",
                isPlantilla: false,
                category: "hogar"
            },
            {
                title: "üîµ‚úÖTapas de Silicona 6 en 1",
                sku: "üîµ‚úÖTapas de Silicona 6 en 1-",
                price: 129900,
                image_url: "https://cdn.shopify.com/s/files/1/0658/1095/6454/files/Silicona-MetaAds.png?v=1750036195",
                isPlantilla: false,
                category: "hogar"
            },
            {
                title: "üîµGuante 3 en 1 para ba√±o de perros",
                sku: "üîµGuante 3 en 1 para ba√±o de perros",
                price: 129900,
                image_url: "https://cdn.shopify.com/s/files/1/0658/1095/6454/files/WhatsAppImage2025-01-08at16.45.04_1.jpg?v=1736365601",
                isPlantilla: false,
                category: "hogar"
            },
            {
                title: "üîµCarrito organizador 4 Niveles y Giro 360¬∞",
                sku: "üîµCarrito organizador 4 Niveles y Giro 360¬∞",
                price: 259000,
                image_url: "https://cdn.shopify.com/s/files/1/0658/1095/6454/files/WhatsAppImage2025-01-08at00.06.56.jpg?v=1736305971",
                isPlantilla: false,
                category: "hogar"
            },
            {
                title: "üîµ‚úÖMesa Proyector para Criaturas",
                sku: "üîµ‚úÖMesa Proyector para Criaturas",
                price: 169900,
                image_url: "https://cdn.shopify.com/s/files/1/0658/1095/6454/files/71INffFqwhL._AC_SL1500.webp?v=1735316685",
                isPlantilla: false,
                category: "hogar"
            },
            {
                title: "üîµ‚úÖDucha Port√°til Recargable",
                sku: "üîµ‚úÖDucha Port√°til Recargable",
                price: 169900,
                image_url: "https://cdn.shopify.com/s/files/1/0658/1095/6454/files/D_NQ_NP_2X_657414-MLU77729347660_072024-F.webp?v=175759628",
                isPlantilla: false,
                category: "hogar"
            },
            {
                title: "üîµCinta Kinesiologica 5MTS",
                sku: "üîµCinta Kinesiologica 5MTS - PROVEEDOR IMPORTADORALIADO",
                price: 119900,
                image_url: "https://cdn.shopify.com/s/files/1/0658/1095/6454/files/WhatsAppImage2024-12-27at23.28.04_1.jpg?v=1735353175",
                isPlantilla: false,
                category: "salud"
            },
            {
                title: "üîµBast√≥n Plegable con Luz Led",
                sku: "üîµBast√≥n Plegable con Luz Led - PROVEEDOR IMPORTADORALIADO",
                price: 169900,
                image_url: "https://cdn.shopify.com/s/files/1/0658/1095/6454/files/WhatsAppImage2025-03-22at21.19.40_1.jpg?v=1742689339",
                isPlantilla: false,
                category: "salud"
            },
            {
                title: "PLANTILLA DEPORTIVA COLOR AZUL CON NEGRO",
                sku: "PLANTILLA DEPORTIVA COLOR AZUL CON NEGRO- 026",
                price: 139900,
                image_url: "https://ae01.alicdn.com/kf/S30f5331381aa4b038d89a4acf33c03e6J.jpg",
                isPlantilla: true,
                category: "plantilla"
            },
            {
                title: "MINI ASPIRADORA",
                sku: "MINI ASPIRADORA - 028",
                price: 119900,
                image_url: "https://cdn.shopify.com/s/files/1/0885/3012/5095/files/ChatGPT_Image_9_ago_2025_09_49_46_p.m._ee0d4101-4eb8-45cf-9b23-e5e1d8c6288c.png?v=1755580613",
                isPlantilla: false,
                category: "hogar"
            },
            {
                title: "PISTOLA MASAJEADORA",
                sku: "PISTOLA MASAJEADORA - 029",
                price: 169900,
                image_url: "https://http2.mlstatic.com/D_NQ_NP_863788-MLA78270636317_082024-O.webp",
                isPlantilla: false,
                category: "salud"
            },
            {
                title: "MINI CAMARA SPY",
                sku: "MINI CAMARA SPY - 030",
                price: 159000,
                image_url: "https://cdn.shopify.com/s/files/1/0885/3012/5095/files/Captura_de_pantalla_2025-07-21_013411.png?v=1757887583",
                isPlantilla: false,
                category: "electronico"
            },
            {
                title: "NIVELADOR AJUSTABLE",
                sku: "NIVELADOR AJUSTABLE A ROSCA - 001",
                price: 129900,
                image_url: "https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTcxOzbFTOhcy6QixwQL6Z18PP4QBkMnOyq2A&s",
                isPlantilla: false,
                category: "herramienta"
            },
            {
                title: "Mini GPS con im√°n y bater√≠a - Geo Ultra",
                sku: "Mini GPS con im√°n y bater√≠a - Geo Ultra - 031",
                price: 199000,
                image_url: "https://m.media-amazon.com/images/I/61LRXMihjEL._AC_SL1500_.jpg",
                isPlantilla: false,
                category: "electronico"
            },
            {
                title: "Cintas M√°gicas De 2 Metros Doble Contacto",
                sku: "Cintas M√°gicas De 2 Metros Doble Contacto -032",
                price: 109000,
                image_url: "https://http2.mlstatic.com/D_NQ_NP_2X_629276-MPE69789861652_062023-F-super-pack-2-cintas-magicas-de-3-metros-doble-contacto.webp",
                isPlantilla: false,
                category: "herramienta"
            },
            {
                title: "PLANTILLA ORTOP√âDICA | ORTOPIEX 5D¬Æ",
                sku: "PLANTILLA ORTOP√âDICA | ORTOPIEX 5D¬Æ -032",
                price: 159000,
                image_url: "https://www.skylinestoree.online/cdn/shop/files/ChatGPT_Image_8_jun_2025_01_04_14_a.m..png?v=1757629829&width=600",
                isPlantilla: true,
                category: "plantilla"
            },
            {
                title: "ASAD LATTAFA - MASCULINO",
                sku: "ASAD LATTAFA 02",
                price: 219900,
                image_url: "data:image/jpeg;base64,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",
                isPlantilla: false,
                category: "hogar"
            },
            {
                title: "üîµ Kit Ejercitador_Antebrazo",
                sku: "üîµ Kit Ejercitador_Antebrazo",
                price: 129900,
                image_url: "https://cdn.shopify.com/s/files/1/0658/1095/6454/files/kit.jpg?v=1742926949",
                isPlantilla: false,
                category: "salud"
            },
            {
                title: "Rejilla Autoadhesiva Pack de 10 unidades",
                sku: "Rejilla Autoadhesiva Pack de 10 unidades - 033",
                price: 99000,
                image_url: "https://acdn-us.mitiendanube.com/stores/001/836/042/products/img_8890-4857d05e74bd140d9517473250670310-1024-1024.webp",
                isPlantilla: false,
                category: "hogar"
            },
            {
                title: "Clip Nasal Anti-Ronquidosüò¥",
                sku: "Clip Nasal Anti-Ronquidosüò¥ - 34",
                price: 95000,
                image_url: "https://www.demodirecta.com/udecontrol_datos/galerias/grandes/355.jpg",
                isPlantilla: false,
                category: "salud"
            },
            {
                title: "Drone Pro Hd",
                sku: "Drone Pro Hd - 035",
                price: 229900,
                image_url: "https://cdn.shopify.com/s/files/1/0707/1979/9484/files/Captura_de_pantalla_2026-02-02_001757.jpg?v=1770002304",
                isPlantilla: false,
                category: "electronico"
            },
            {
                title: "ALUMBRADO SOLAR IP67 - 90W",
                sku: "ALUMBRADO SOLAR IP67 - 90W - 036",
                price: 169900,
                image_url: "https://cdn.shopify.com/s/files/1/0885/3012/5095/files/WhatsApp_Image_2026-01-30_at_7.53.56_PM.jpg?v=1769813758",
                isPlantilla: false,
                category: "electronico"
            },
            {
                title: "V-SHAPED - CINTA FACIAL",
                sku: "V-SHAPED - CINTA FACIAL - 038",
                price: 139900,
                image_url: "https://gran7.com.py/PRO/todas_las_img2/1614_25_9.jpg",
                isPlantilla: false,
                category: "salud"
            }
        ];

        // Variables globales para el carrito
        let currentProduct = null;
        let quantity = 1;
        let selectedSize = null;
        let selectedShipping = "standard";
        let selectedTemplates = [];
        let templateSizes = {};
        const expressShippingPrice = 8000;
        let cart = [];

        // Formatear precio en guaran√≠es
        function formatPrice(price) {
            return price.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ".") + " Gs";
        }

        // Obtener nombre de categor√≠a en espa√±ol
        function getCategoryName(category) {
            const names = {
                plantilla: "Plantilla Ortop√©dica",
                electronico: "Electr√≥nico",
                hogar: "Hogar",
                salud: "Salud y Bienestar",
                herramienta: "Herramienta"
            };
            return names[category] || "General";
        }

        // Generar URL √∫nica por producto
        function generateProductUrl(productIndex) {
            const product = products[productIndex];
            const baseUrl = window.location.origin + window.location.pathname;
            const slug = product.title.toLowerCase()
                .replace(/[^\w\s]/gi, '')
                .replace(/\s+/g, '-');
            return `${baseUrl}?product=${slug}&id=${productIndex}`;
        }

        // Copiar enlace del producto
        function copyProductLink(productIndex) {
            const url = generateProductUrl(productIndex);
            navigator.clipboard.writeText(url).then(() => {
                alert('¬°Enlace copiado al portapapeles! Comparte este producto con tus clientes.');
            }).catch(err => {
                console.error('Error al copiar: ', err);
            });
        }

        // Cargar productos en el cat√°logo
        function loadProducts() {
            const catalogGrid = document.getElementById('catalog');
            const searchTerm = document.getElementById('searchInput').value.toLowerCase();
            const activeFilter = document.querySelector('.filter-btn.active').dataset.filter;
            
            // Limpiar grid
            catalogGrid.innerHTML = '';
            
            // Filtrar productos
            let filteredProducts = products;
            
            if (searchTerm) {
                filteredProducts = filteredProducts.filter(product => 
                    product.title.toLowerCase().includes(searchTerm) || 
                    product.sku.toLowerCase().includes(searchTerm)
                );
            }
            
            if (activeFilter !== 'all') {
                filteredProducts = filteredProducts.filter(product => 
                    product.category === activeFilter
                );
            }
            
            // Actualizar contador
            document.getElementById('productCounter').textContent = 
                `Mostrando ${filteredProducts.length} de ${products.length} productos`;
            
            // Crear tarjetas de productos
            filteredProducts.forEach((product, index) => {
                const originalIndex = products.findIndex(p => p.sku === product.sku);
                
                const productCard = document.createElement('div');
                productCard.className = 'product-card';
                
                // Determinar si mostrar badge de plantilla
                const badges = product.isPlantilla ? 
                    `<div class="product-badge">PLANTILLA</div>
                     <div class="product-badge category">${getCategoryName(product.category)}</div>` : 
                    `<div class="product-badge category">${getCategoryName(product.category)}</div>`;
                
                productCard.innerHTML = `
                    <button class="share-button" onclick="copyProductLink(${originalIndex})">
                        <i class="fas fa-share-alt"></i>
                        <div class="share-tooltip">
                            <input type="text" value="${generateProductUrl(originalIndex)}" readonly>
                            <button class="copy-btn" onclick="copyProductLink(${originalIndex})">
                                <i class="fas fa-copy"></i> Copiar enlace
                            </button>
                        </div>
                    </button>
                    
                    ${badges}
                    <img src="${product.image_url}" alt="${product.title}" class="product-image" onerror="this.src='https://via.placeholder.com/300x220?text=Imagen+no+disponible'">
                    <div class="product-info">
                        <h3 class="product-title">${product.title}</h3>
                        <p class="product-sku">SKU: ${product.sku}</p>
                        <p class="product-price">${formatPrice(product.price)}</p>
                        <div class="product-actions">
                            <button class="view-button" data-index="${originalIndex}">
                                <i class="fas fa-eye"></i> Ver Detalles
                            </button>
                            <button class="buy-button pulse" data-index="${originalIndex}">
                                <i class="fas fa-shopping-cart"></i> Comprar
                            </button>
                        </div>
                    </div>
                `;
                
                catalogGrid.appendChild(productCard);
            });
            
            // Reasignar event listeners
            document.querySelectorAll('.view-button').forEach(button => {
                button.addEventListener('click', function() {
                    const productIndex = parseInt(this.getAttribute('data-index'));
                    openDetailModal(productIndex);
                });
            });
            
            document.querySelectorAll('.buy-button').forEach(button => {
                button.addEventListener('click', function() {
                    const productIndex = parseInt(this.getAttribute('data-index'));
                    openPurchaseModal(productIndex);
                });
            });
        }

        // Abrir modal de detalles
        function openDetailModal(productIndex) {
            currentProduct = products[productIndex];
            
            // Obtener caracter√≠sticas y descripci√≥n seg√∫n categor√≠a
            const features = productFeatures[currentProduct.category] || productFeatures.hogar;
            const description = productDescriptions[currentProduct.category] || productDescriptions.hogar;
            
            // Construir caracter√≠sticas HTML
            let featuresHTML = '';
            features.forEach(feature => {
                featuresHTML += `
                    <div class="feature-item">
                        <i class="${feature.icon} feature-icon"></i>
                        <span class="feature-text">${feature.text}</span>
                    </div>
                `;
            });
            
            // Determinar informaci√≥n adicional para plantillas
            const plantillaInfo = currentProduct.isPlantilla ? 
                `<p><strong>Calces disponibles:</strong> 35 al 45</p>
                 <p><strong>Tipo:</strong> Ortop√©dica 5D</p>
                 <p><strong>Material:</strong> Antimicrobiano y transpirable</p>` : '';
            
            // Construir contenido del modal
            const detailContent = `
                <div class="product-detail-container">
                    <div>
                        <img src="${currentProduct.image_url}" alt="${currentProduct.title}" class="product-detail-image" onerror="this.src='https://via.placeholder.com/400x300?text=Imagen+no+disponible'">
                    </div>
                    <div class="product-detail-info">
                        <h3>${currentProduct.title}</h3>
                        <p class="product-detail-sku">SKU: ${currentProduct.sku}</p>
                        <div class="product-detail-price">${formatPrice(currentProduct.price)}</div>
                        
                        <div class="product-description">
                            <h4><i class="fas fa-info-circle"></i> Descripci√≥n</h4>
                            <p>${description}</p>
                            ${plantillaInfo}
                        </div>
                    </div>
                </div>
                
                <div class="product-features">
                    <h4><i class="fas fa-star"></i> Caracter√≠sticas Principales</h4>
                    <div class="features-grid">
                        ${featuresHTML}
                    </div>
                </div>
                
                <div class="detail-actions">
                    <button class="detail-close-button" id="detailCloseBtn">
                        <i class="fas fa-times"></i> Cerrar
                    </button>
                    <button class="detail-buy-button" id="detailBuyBtn">
                        <i class="fas fa-shopping-cart"></i> Comprar Ahora
                    </button>
                </div>
            `;
            
            // Insertar contenido en el modal
            document.getElementById('productDetailContent').innerHTML = detailContent;
            
            // Mostrar modal
            document.getElementById('detailModal').style.display = 'flex';
            document.body.style.overflow = 'hidden';
            
            // A√±adir event listeners a los botones dentro del modal
            document.getElementById('detailCloseBtn').addEventListener('click', closeDetailModal);
            document.getElementById('detailBuyBtn').addEventListener('click', () => {
                closeDetailModal();
                openPurchaseModal(productIndex);
            });
        }

        // Cerrar modal de detalles
        function closeDetailModal() {
            document.getElementById('detailModal').style.display = 'none';
            document.body.style.overflow = 'auto';
        }

        // Validar formulario
        function validateForm() {
            const customerName = document.getElementById('customerName').value.trim();
            const customerPhone = document.getElementById('customerPhone').value.trim();
            const customerAddress = document.getElementById('customerAddress').value.trim();
            
            // Validar campos obligatorios
            const allFieldsFilled = customerName && customerPhone && customerAddress;
            
            // Validar calces para plantillas
            let sizesValid = true;
            
            if (selectedTemplates.length > 0) {
                const plantillaTemplates = selectedTemplates.filter(t => t.isPlantilla);
                sizesValid = plantillaTemplates.length === 0 || Object.keys(templateSizes).length === plantillaTemplates.length;
            }
            
            // Habilitar o deshabilitar bot√≥n
            const whatsappButton = document.getElementById('whatsappButton');
            if (allFieldsFilled && sizesValid) {
                whatsappButton.disabled = false;
                whatsappButton.style.opacity = "1";
                whatsappButton.style.cursor = "pointer";
            } else {
                whatsappButton.disabled = true;
                whatsappButton.style.opacity = "0.7";
                whatsappButton.style.cursor = "not-allowed";
            }
            
            // Mostrar/ocultar mensaje de validaci√≥n
            const validationMsg = document.getElementById('sizeValidationMessage');
            if (selectedTemplates.length > 0 && !sizesValid) {
                const plantillaTemplates = selectedTemplates.filter(t => t.isPlantilla);
                validationMsg.textContent = `Debes seleccionar calce para ${plantillaTemplates.length} plantilla(s)`;
                validationMsg.classList.add('show');
            } else {
                validationMsg.classList.remove('show');
            }
        }

        // Abrir modal de compra
        function openPurchaseModal(productIndex) {
            currentProduct = products[productIndex];
            quantity = 1;
            
            // Inicializar arrays si es necesario
            if (!selectedTemplates.includes(currentProduct)) {
                selectedTemplates = [currentProduct];
                templateSizes = {};
            }
            
            // Actualizar informaci√≥n del producto en el modal
            document.getElementById('modalProductImage').src = currentProduct.image_url;
            document.getElementById('modalProductImage').alt = currentProduct.title;
            document.getElementById('modalProductTitle').textContent = currentProduct.title;
            document.getElementById('modalProductSku').textContent = `SKU: ${currentProduct.sku}`;
            document.getElementById('modalProductPrice').textContent = formatPrice(currentProduct.price);
            
            // Mostrar/ocultar selector de calce si es plantilla
            const sizeContainer = document.getElementById('sizeContainer');
            const sizeOptions = document.getElementById('sizeOptions');
            const multiTemplateInfo = document.getElementById('multiTemplateInfo');
            
            if (currentProduct.isPlantilla) {
                sizeContainer.style.display = 'block';
                
                // Mostrar informaci√≥n de m√∫ltiples plantillas
                const plantillaTemplates = selectedTemplates.filter(t => t.isPlantilla);
                if (plantillaTemplates.length > 1) {
                    multiTemplateInfo.style.display = 'block';
                    document.getElementById('templateMessage').textContent = 
                        `Est√°s comprando ${plantillaTemplates.length} plantillas. Selecciona calce para cada una:`;
                    
                    // Actualizar lista
                    const templateList = document.getElementById('templateList');
                    templateList.innerHTML = '';
                    selectedTemplates.forEach((template, idx) => {
                        if (template.isPlantilla) {
                            const li = document.createElement('li');
                            li.innerHTML = `${template.title} - ${templateSizes[idx] ? 'Calce: ' + templateSizes[idx] : '<span style="color:#e74c3c">Pendiente</span>'}`;
                            templateList.appendChild(li);
                        }
                    });
                } else {
                    multiTemplateInfo.style.display = 'none';
                }
                
                // Generar opciones de calce (35-45)
                sizeOptions.innerHTML = '';
                for (let i = 35; i <= 45; i++) {
                    const sizeOption = document.createElement('div');
                    sizeOption.className = `size-option ${templateSizes[productIndex] === i ? 'selected' : ''}`;
                    sizeOption.textContent = i;
                    sizeOption.addEventListener('click', function() {
                        // Guardar calce para esta plantilla espec√≠fica
                        templateSizes[productIndex] = i;
                        
                        // Actualizar selecci√≥n visual
                        document.querySelectorAll('.size-option').forEach(option => {
                            option.classList.remove('selected');
                        });
                        this.classList.add('selected');
                        
                        // Actualizar lista si hay m√∫ltiples plantillas
                        if (selectedTemplates.filter(t => t.isPlantilla).length > 1) {
                            const templateList = document.getElementById('templateList');
                            templateList.innerHTML = '';
                            selectedTemplates.forEach((template, idx) => {
                                if (template.isPlantilla) {
                                    const li = document.createElement('li');
                                    li.innerHTML = `${template.title} - ${templateSizes[idx] ? 'Calce: ' + templateSizes[idx] : '<span style="color:#e74c3c">Pendiente</span>'}`;
                                    templateList.appendChild(li);
                                }
                            });
                        }
                        
                        // Validar formulario
                        validateForm();
                        updateOrderSummary();
                    });
                    sizeOptions.appendChild(sizeOption);
                    
                    // Seleccionar el primer tama√±o si ya hay uno guardado
                    if (templateSizes[productIndex] === i) {
                        sizeOption.classList.add('selected');
                    }
                }
            } else {
                sizeContainer.style.display = 'none';
                multiTemplateInfo.style.display = 'none';
            }
            
            // Actualizar cantidad
            document.getElementById('quantityDisplay').textContent = quantity;
            
            // Actualizar resumen
            updateOrderSummary();
            
            // Mostrar modal
            document.getElementById('purchaseModal').style.display = 'flex';
            document.body.style.overflow = 'hidden';
            
            // Validar formulario inicialmente
            validateForm();
        }

        // Actualizar resumen de la orden
        function updateOrderSummary() {
            if (!currentProduct) return;
            
            const unitPrice = currentProduct.price;
            const subtotal = unitPrice * quantity;
            const shippingCost = selectedShipping === "express" ? expressShippingPrice : 0;
            const total = subtotal + shippingCost;
            
            document.getElementById('subtotalAmount').textContent = formatPrice(subtotal);
            document.getElementById('shippingAmount').textContent = selectedShipping === "express" ? formatPrice(expressShippingPrice) : "Gratis";
            document.getElementById('totalAmount').textContent = formatPrice(total);
        }

        // Enviar pedido por WhatsApp
        function sendWhatsAppOrder() {
            if (!currentProduct) return;
            
            // Validar campos requeridos
            const customerName = document.getElementById('customerName').value.trim();
            const customerPhone = document.getElementById('customerPhone').value.trim();
            const customerAddress = document.getElementById('customerAddress').value.trim();
            
            if (!customerName || !customerPhone || !customerAddress) {
                alert('Por favor, completa todos los campos requeridos (Nombre, Tel√©fono y Direcci√≥n)');
                return;
            }
            
            // Validar calces para plantillas
            if (selectedTemplates.some(t => t.isPlantilla)) {
                const plantillaTemplates = selectedTemplates.filter(t => t.isPlantilla);
                if (Object.keys(templateSizes).length < plantillaTemplates.length) {
                    alert('Por favor, selecciona calce para todas las plantillas antes de continuar');
                    return;
                }
            }
            
            // Calcular total
            const unitPrice = currentProduct.price;
            const subtotal = unitPrice * quantity;
            const shippingCost = selectedShipping === "express" ? expressShippingPrice : 0;
            const total = subtotal + shippingCost;
            
            // Preparar mensaje
            let message = `üöÄ *NUEVO PEDIDO - Cat√°logo Premium Pro*\n\n`;
            
            // Informaci√≥n de productos
            if (selectedTemplates.length === 1) {
                message += `üì¶ *Producto:* ${currentProduct.title}\n`;
                message += `üìã *SKU:* ${currentProduct.sku}\n`;
                
                if (currentProduct.isPlantilla && templateSizes[0]) {
                    message += `üëü *Calce seleccionado:* ${templateSizes[0]}\n`;
                }
            } else {
                message += `üì¶ *Productos seleccionados:*\n`;
                selectedTemplates.forEach((template, idx) => {
                    message += `   ‚Ä¢ ${template.title}`;
                    if (template.isPlantilla && templateSizes[idx]) {
                        message += ` (Calce: ${templateSizes[idx]})`;
                    }
                    message += `\n`;
                });
            }
            
            message += `üí∞ *Precio unitario:* ${formatPrice(unitPrice)}\n`;
            message += `üì¶ *Cantidad:* ${quantity}\n`;
            message += `üßæ *Subtotal:* ${formatPrice(subtotal)}\n\n`;
            
            message += `üöö *Env√≠o:* ${selectedShipping === "express" ? "R√ÅPIDO (24-48h) - " + formatPrice(expressShippingPrice) : "Est√°ndar (3-5 d√≠as) - Gratis"}\n`;
            message += `üíµ *TOTAL A PAGAR:* ${formatPrice(total)}\n\n`;
            
            message += `üë§ *Datos del cliente:*\n`;
            message += `   ‚Ä¢ Nombre: ${customerName}\n`;
            message += `   ‚Ä¢ Tel√©fono: ${customerPhone}\n`;
            message += `   ‚Ä¢ Direcci√≥n: ${customerAddress}\n`;
            
            message += `\n‚è∞ *Fecha:* ${new Date().toLocaleDateString('es-PY')} ${new Date().toLocaleTimeString('es-PY')}\n`;
            message += `üîó *Enlace del producto:* ${generateProductUrl(products.indexOf(currentProduct))}`;
            
            // N√∫mero de WhatsApp
            const phoneNumber = "595992526814";
            const encodedMessage = encodeURIComponent(message);
            const whatsappURL = `https://wa.me/${phoneNumber}?text=${encodedMessage}`;
            
            // Abrir WhatsApp en nueva pesta√±a
            window.open(whatsappURL, '_blank');
            
            // A√±adir al carrito
            addToCart();
            
            // Cerrar modal
            closeModal();
        }

        // A√±adir producto al carrito
        function addToCart() {
            const item = {
                product: currentProduct,
                quantity: quantity,
                size: selectedSize,
                shipping: selectedShipping
            };
            
            cart.push(item);
            updateCart();
        }

        // Actualizar contador del carrito
        function updateCart() {
            document.getElementById('cartCount').textContent = cart.length;
        }

        // Cerrar modal de compra
        function closeModal() {
            document.getElementById('purchaseModal').style.display = 'none';
            document.body.style.overflow = 'auto';
            
            // Limpiar formulario
            document.getElementById('purchaseForm').reset();
            document.querySelectorAll('.size-option').forEach(option => {
                option.classList.remove('selected');
            });
            
            selectedSize = null;
            quantity = 1;
            selectedTemplates = [];
            templateSizes = {};
            
            // Resetear selecci√≥n de env√≠o
            document.getElementById('standardShipping').classList.add('selected');
            document.getElementById('expressShipping').classList.remove('selected');
        }

        // Inicializar la p√°gina
        document.addEventListener('DOMContentLoaded', function() {
            // Cargar productos
            loadProducts();
            
            // Event listeners para cerrar modales
            document.getElementById('closeDetailModal').addEventListener('click', closeDetailModal);
            document.getElementById('closeModal').addEventListener('click', closeModal);
            
            // Cerrar modal de detalles al hacer clic fuera
            document.getElementById('detailModal').addEventListener('click', function(e) {
                if (e.target === this) {
                    closeDetailModal();
                }
            });
            
            // Cerrar modal de compra al hacer clic fuera
            document.getElementById('purchaseModal').addEventListener('click', function(e) {
                if (e.target === this) {
                    closeModal();
                }
            });
            
            // Botones de cantidad
            document.getElementById('increaseQty').addEventListener('click', function() {
                quantity++;
                document.getElementById('quantityDisplay').textContent = quantity;
                updateOrderSummary();
            });
            
            document.getElementById('decreaseQty').addEventListener('click', function() {
                if (quantity > 1) {
                    quantity--;
                    document.getElementById('quantityDisplay').textContent = quantity;
                    updateOrderSummary();
                }
            });
            
            // Opciones de env√≠o
            document.getElementById('standardShipping').addEventListener('click', function() {
                document.getElementById('shippingStandard').checked = true;
                selectedShipping = "standard";
                updateOrderSummary();
                this.classList.add('selected');
                document.getElementById('expressShipping').classList.remove('selected');
            });
            
            document.getElementById('expressShipping').addEventListener('click', function() {
                document.getElementById('shippingExpress').checked = true;
                selectedShipping = "express";
                updateOrderSummary();
                this.classList.add('selected');
                document.getElementById('standardShipping').classList.remove('selected');
            });
            
            // Bot√≥n de WhatsApp
            document.getElementById('whatsappButton').addEventListener('click', sendWhatsAppOrder);
            
            // Validar en tiempo real para habilitar/deshabilitar bot√≥n
            const formInputs = document.querySelectorAll('#purchaseForm input, #purchaseForm textarea');
            formInputs.forEach(input => {
                input.addEventListener('input', validateForm);
            });
            
            // Filtros y b√∫squeda
            document.getElementById('searchInput').addEventListener('input', loadProducts);
            
            document.querySelectorAll('.filter-btn').forEach(button => {
                button.addEventListener('click', function() {
                    document.querySelectorAll('.filter-btn').forEach(btn => {
                        btn.classList.remove('active');
                    });
                    this.classList.add('active');
                    loadProducts();
                });
            });
            
            // Bot√≥n del carrito
            document.getElementById('cartButton').addEventListener('click', function() {
                if (cart.length > 0) {
                    alert(`Tienes ${cart.length} producto(s) en el carrito.\n\n${cart.map(item => `‚Ä¢ ${item.product.title} x${item.quantity}`).join('\n')}`);
                } else {
                    alert('Tu carrito est√° vac√≠o');
                }
            });
            
            // Cargar producto desde URL
            const urlParams = new URLSearchParams(window.location.search);
            const productSlug = urlParams.get('product');
            const productId = urlParams.get('id');
            
            if (productId) {
                const productIndex = parseInt(productId);
                if (productIndex >= 0 && productIndex < products.length) {
                    setTimeout(() => openDetailModal(productIndex), 500);
                }
            } else if (productSlug) {
                const productIndex = products.findIndex(p => 
                    p.title.toLowerCase().replace(/[^\w\s]/gi, '').replace(/\s+/g, '-') === productSlug
                );
                if (productIndex !== -1) {
                    setTimeout(() => openDetailModal(productIndex), 500);
                }
            }
        });
    </script>
</body>
</html>
